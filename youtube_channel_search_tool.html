<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>YouTube Channel Search Tool</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<style>
  body { font-family: Arial, sans-serif; background:#fafafa; margin: 20px; }
  input, select, button { margin:5px; padding:5px; }
  .filters, .search-box { margin-bottom: 15px; }
  .card { display:inline-block; width:300px; border:1px solid #ccc; border-radius:10px; padding:10px; margin:5px; background:#fff; vertical-align:top; }
  .card img { width:100%; border-radius:8px; }
  table { width:100%; border-collapse:collapse; background:#fff; }
  th, td { border:1px solid #ccc; padding:8px; text-align:left; resize:horizontal; overflow:auto; }
  th { background:#f2f2f2; }
  #results { margin-top: 20px; }
</style>
</head>
<body>
  <h2>ğŸ“º YouTube ì±„ë„ ì¡°íšŒ ë„êµ¬</h2>
  <div class="search-box">
    <label>API Key: </label><input type="password" id="apiKey" placeholder="API í‚¤ë¥¼ ì…ë ¥í•˜ì„¸ìš”">
    <br>
    <label>ê²€ìƒ‰ì–´: </label><input type="text" id="query" placeholder="ì˜ˆ: ì—¬í–‰ ë¸Œì´ë¡œê·¸">
    <button onclick="searchVideos()">ê²€ìƒ‰</button>
  </div>

  <div class="filters">
    <h4>í•„í„°</h4>
    <div>
      <b>ì˜ìƒ ê¸¸ì´:</b>
      <label><input type="checkbox" class="length-filter" value="short"> ìˆí¼(1ë¶„ ë¯¸ë§Œ)</label>
      <label><input type="checkbox" class="length-filter" value="long"> ë¡±í¼(1ë¶„ ì´ìƒ)</label>
    </div>
    <div>
      <b>ì—…ë¡œë“œ ê¸°ê°„:</b>
      <label><input type="checkbox" class="time-filter" value="1"> 1ê°œì›”</label>
      <label><input type="checkbox" class="time-filter" value="2"> 2ê°œì›”</label>
      <label><input type="checkbox" class="time-filter" value="3"> 3ê°œì›”</label>
      <label><input type="checkbox" class="time-filter" value="6"> 6ê°œì›”</label>
      <label><input type="checkbox" class="time-filter" value="12"> 1ë…„</label>
    </div>
    <div>
      <b>ì¡°íšŒìˆ˜/êµ¬ë…ì ë¹„ìœ¨:</b>
      <label><input type="checkbox" class="ratio-filter" value="1"> 1ë‹¨ê³„</label>
      <label><input type="checkbox" class="ratio-filter" value="3"> 3ë‹¨ê³„</label>
      <label><input type="checkbox" class="ratio-filter" value="5"> 5ë‹¨ê³„</label>
    </div>
  </div>

  <div>
    <button onclick="toggleMode('card')">ì¹´ë“œ ë³´ê¸°</button>
    <button onclick="toggleMode('table')">í…Œì´ë¸” ë³´ê¸°</button>
    <button onclick="exportToExcel()">ì—‘ì…€ë¡œ ì €ì¥</button>
  </div>

  <div id="results"></div>

<script>
let mode = 'card';
let allVideos = [];

function toggleMode(selected) {
  mode = selected;
  displayResults();
}

async function searchVideos() {
  const API_KEY = document.getElementById('apiKey').value.trim();
  const query = document.getElementById('query').value.trim();
  if (!API_KEY || !query) return alert('API í‚¤ì™€ ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”');

  const searchUrl = `https://www.googleapis.com/youtube/v3/search?part=snippet&type=video&maxResults=20&q=${encodeURIComponent(query)}&key=${API_KEY}`;
  const searchRes = await fetch(searchUrl);
  const searchData = await searchRes.json();

  const videoIds = searchData.items.map(v => v.id.videoId).join(',');
  const statsUrl = `https://www.googleapis.com/youtube/v3/videos?part=snippet,contentDetails,statistics&id=${videoIds}&key=${API_KEY}`;
  const statsRes = await fetch(statsUrl);
  const statsData = await statsRes.json();

  allVideos = statsData.items.map(v => ({
    title: v.snippet.title,
    description: v.snippet.description,
    channel: v.snippet.channelTitle,
    tags: v.snippet.tags ? v.snippet.tags.join(', ') : '',
    thumbnail: v.snippet.thumbnails.medium.url,
    url: `https://www.youtube.com/watch?v=${v.id}`,
    viewCount: v.statistics.viewCount || 0,
    likeCount: v.statistics.likeCount || 0,
    duration: v.contentDetails.duration,
    publishedAt: v.snippet.publishedAt
  }));

  displayResults();
}

function displayResults() {
  const container = document.getElementById('results');
  container.innerHTML = '';

  if (mode === 'card') {
    allVideos.forEach(v => {
      const div = document.createElement('div');
      div.className = 'card';
      div.innerHTML = `
        <img src="${v.thumbnail}" alt="thumbnail">
        <h4>${v.title}</h4>
        <p>${v.channel}</p>
        <p>ì¡°íšŒìˆ˜: ${v.viewCount}</p>
        <a href="${v.url}" target="_blank">ì˜ìƒ ë³´ê¸°</a>
      `;
      container.appendChild(div);
    });
  } else {
    let table = '<table><thead><tr><th>ì œëª©</th><th>ì±„ë„</th><th>ì¡°íšŒìˆ˜</th><th>ì„¤ëª…</th><th>ë§í¬</th></tr></thead><tbody>';
    allVideos.forEach(v => {
      table += `<tr><td>${v.title}</td><td>${v.channel}</td><td>${v.viewCount}</td><td>${v.description}</td><td><a href='${v.url}' target='_blank'>ë³´ê¸°</a></td></tr>`;
    });
    table += '</tbody></table>';
    container.innerHTML = table;
  }
}

function exportToExcel() {
  if (allVideos.length === 0) return alert('ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤');
  const ws = XLSX.utils.json_to_sheet(allVideos);
  const wb = XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(wb, ws, 'YouTubeData');
  XLSX.writeFile(wb, 'youtube_data.xlsx');
}
</script>
</body>
</html>
